<p id="notice"><%= notice %></p>

<p>
  <h3>Category:</h3>
  <%= @ticket.category %>
</p>

<p>
  <h3>Equipment:</h3>
  <%= @ticket.equipment %>
</p>

<p>
  <h3>Hardware:</h3>
  <%= @ticket.hardware %>
</p>

<p>
  <h3>Software:</h3>
  <%= @ticket.software %>
</p>

<p>
  <h3>Description:</h3>
  <%= @ticket.description %>
</p>

<p>
  <h3>Status:</h3>
  <%if @ticket.status == true %>
    <p>Open</p>
  <% elsif @ticket.status == false %>
    <p>Closed</p>
  <% end %>
</p>

<p>
  <h3>Walk in:</h3>
  <%= @ticket.walk_in %>
</p>

<p>
  <h3>For Customer:</h3>
  <%= @ticket.customer.fullname%>
</p>

<p>
  <h3>Made By:</h3>
  <%= @ticket.user.fullname %>
</p>

<% if @ticket.closed_by != nil %>
  <p>
    <h3>Closed By:</h3>
    <%= @ticket.closer.fullname %>
  </p>
<% end %>

<%= link_to 'Edit', edit_ticket_path(@ticket) %> |
<%= link_to 'Back', dashboard_path %>

<%if @ticket.status == true %>
  <%= button_to 'Close Ticket', close_path(@ticket), method: :patch, data: { confirm: "It's best practice to close a ticket using the comment/trip feature by checking resolved. Are you sure you want to close this ticket without giving feedback?" } %>
<%else%>
  <%= button_to 'Reopen Ticket', open_path(@ticket), method: :patch, data: { confirm: "Are you sure you want to reopen this ticket?" } %>
<%end%>

<%if @ticket.status == false && @ticket.user_id == current_user.id %>
  <%= button_to 'Delete Ticket', ticket_path(@ticket), method: :delete, data: { confirm: "Are you sure you want to delete this ticket?" } %>
<% end %>

<% if @ticket.trips.empty? %>
<% else %>
  <h1>Trips/Comments</h1>

  <table>

    <tr>
      <th>Number</th>
      <th>Made</th>
      <th>Comment</th>
      <th>Time Spent</th>
      <th>Tech</th>
      <th>Resolved?</th>
    </tr>

    <%@ticket.trips.reverse.each_with_index do |f, i|%>
      <tr>
          <td><%=i + 1%></td>
          <td><%=time_ago_in_words(f.created_at)%></td>
          <td><%=f.comment%></td>
          <td><%=f.duration%></td>
          <td><%=f.user.fname + " " + f.user.lname%></td>
          <td><% if f.resolved == false %> No <% elsif f.resolved == true  %> Yes <%end%></td>
      </tr>
    <%end%>

  </table>
<% end %>

<%if @ticket.status == true%>
  <h1>Add a Trip/Comment</h1>
  <%= render "trips/form.html.erb", trip: @trip %>
<%end%>

